{% extends 'base.html' %}
{% block title %}Níveis de Combustível · Trivia Monitora{% endblock %}
{% block content %}
<section class="fuel-overview">
    <header class="fuel-overview__header card">
        <div>
            <p class="eyebrow">Monitoramento em tempo real</p>
            <h2>Níveis de combustível dos geradores</h2>
            <p class="subtitle">Visualize rapidamente o status dos equipamentos com exibição habilitada.</p>
        </div>
        <div class="fuel-overview__meta">
            {% if last_refresh %}
                <span class="last-refresh">Última atualização: <strong>{{ last_refresh }}</strong></span>
            {% else %}
                <span class="last-refresh is-muted">Sem registros recentes</span>
            {% endif %}
        </div>
    </header>

    {% if fuel_levels %}
        <div class="fuel-grid">
            {% for equipamento in fuel_levels %}
                <article class="fuel-card fuel-card--{{ equipamento.nivel_status }}">
                    <header class="fuel-card__header">
                        <div>
                            <p class="eyebrow">{{ equipamento.local }}</p>
                            <h3>{{ equipamento.nome }}</h3>
                        </div>
                        <span class="fuel-card__level-text">{{ equipamento.nivel_display }}</span>
                    </header>

                    <div class="fuel-meter" role="img" aria-label="Nível atual de {{ equipamento.nivel_display }} para {{ equipamento.nome }}">
                        <div class="fuel-meter__track"></div>
                        <div class="fuel-meter__fill" style="--fuel-level: {{ equipamento.nivel_percent or 0 }}%;"></div>
                        <div class="fuel-meter__glow"></div>
                    </div>

                    <dl class="fuel-card__stats">
                        <div>
                            <dt>Nível</dt>
                            <dd>{{ equipamento.nivel_display }}</dd>
                        </div>
                        <div>
                            <dt>Autonomia estimada</dt>
                            <dd>{{ equipamento.autonomia_display or '—' }}</dd>
                        </div>
                        <div>
                            <dt>Volume do tanque</dt>
                            <dd>{{ equipamento.volume_tanque or '—' }}</dd>
                        </div>
                        <div>
                            <dt>Local</dt>
                            <dd>{{ equipamento.local }}</dd>
                        </div>
                        <div>
                            <dt>Última atualização</dt>
                            <dd>
                                {% if equipamento.ultima_atualizacao_display %}
                                    <time datetime="{{ equipamento.ultima_atualizacao_iso }}">{{ equipamento.ultima_atualizacao_display }}</time>
                                {% else %}
                                    —
                                {% endif %}
                            </dd>
                        </div>
                    </dl>
                </article>
            {% endfor %}
        </div>
    {% else %}
        <div class="empty-state card">
            <h3>Sem dados visíveis</h3>
            <p>Nenhum gerador com "exibeNivel" ativo foi encontrado na tabela de equipamentos.</p>
        </div>
    {% endif %}
</section>
{% endblock %}
